name: Build Packer Template
on:
  pull_request:
    types: [opened, reopened]

jobs:
 Build-Packer-Template:
   if: contains(github.event.pull_request.labels.*.name, 'packer')
   environment: ${{ github.event.pull_request.head.ref }}
   container:
    image: eu.gcr.io/stuttgart-things/sthings-packer:1.10.2-9.4.0-2
    # options: --user=root
   runs-on: ghr-stuttgart-things-sthings-cicd
   steps:
     - name: Checkout code/branch
       id: checkout
       uses: actions/checkout@v4

     - name: Check config / folder content
       id: check
       run: |
         ls -lta packer/builds/${{ github.event.pull_request.head.ref }}
         packer --version
         ansible --version
