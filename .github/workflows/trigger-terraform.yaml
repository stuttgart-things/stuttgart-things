---
name: Trigger terraform run
on:
  workflow_dispatch:
    inputs:
      operation:
        type: choice
        description: TERRAFORM OPERATION
        options:
          - apply
          - destroy
      runner:
        description: RUNNER NAME
        type: string
        default: ghr-stuttgart-things-sthings-cicd
      environment-name:
        type: choice
        description: ENVIRONMENT NAME
        options:
          - labda-vsphere
          - labul-vsphere
      working-image:
        description: WORKING IMAGE
        type: string
        default: eu.gcr.io/stuttgart-things/sthings-terraform:1.8.1-1



jobs:
  execute-terraform:
    name: Execute Terraform
    uses: stuttgart-things/stuttgart-things/.github/workflows/execute-terraform.yaml@main
    with:
      folder: terraform/builds/vspherevm/labul/test
      branch: ubuntu23-labul-vsphere
      operation: ${{ inputs.operation }}
      working-image: ${{ inputs.working-image}}
      environment-name: ${{ inputs.environment-name }}
      runs-on: ${{ inputs.runner }}