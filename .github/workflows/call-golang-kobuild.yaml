---
name: Golang Ko OCI Image-Build
on:
  workflow_call:
    inputs:
      runs-on:
        required: true
        type: string
      environment-name:
        default: k8s
        required: false
        type: string
      dockerfile:
        required: false
        default: "./Dockerfile"
        type: string
      registry:
        required: false
        default:  ghcr.io
        type: string
      repository:
        required: false
        default: stuttgart-things
        type: string
      image:
        required: true
        type: string
      tag:
        required: true
        type: string
      kaniko-image:
        required: false
        type: string
        default: gcr.io/kaniko-project/executor
      kaniko-tag:
        required: false
        type: string
        default: debug
      push-retrys:
        required: false
        type: string
        default: "5"
jobs:
  kaniko-build:
    runs-on: ${{ inputs.runs-on }}
    environment: ${{ inputs.environment-name }}
    env:
      IMAGE_TAG: ${{ inputs.tag }}
    container:
      image: ${{ inputs.kaniko-image }}:${{ inputs.kaniko-tag }}
    steps:
      - name: Build and push image w/ kaniko
        run: |
