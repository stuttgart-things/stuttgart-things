---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: tekton-resources
  namespace: tekton-cd
spec:
  interval: 30m
  chart:
    spec:
      chart: yacht-tekton-resources
      version: v0.47.10
      sourceRef:
        kind: HelmRepository
        name: stuttgart-things
        namespace: tekton-pipelines
      interval: 12h
  dependsOn:
    - name: tekton-pipelines
      namespace: tekton-pipelines
  values:
    enableWorkspaces: true
    enableGitSecretsSSH: false
    enableSecrets: false
    enableRegistryCredentials: false
    enablePipelines: false
    enableTasks: false
    enableRuns: false

    workspaces:
      kaniko-workspace:
        namespace: ${TKN_NAMESPACE}
        volumeMode: Filesystem
        storageClassName: ${TKN_STORAGE_CLASS}
        storage: ${TKN_KANIKO_STORAGE}
        accessModes:
          - ReadWriteOnce
      helm-workspace:
        namespace: ${TKN_NAMESPACE}
        volumeMode: Filesystem
        storageClassName: ${TKN_STORAGE_CLASS}
        storage: ${TKN_HELM_STORAGE}
        accessModes:
          - ReadWriteOnce

      registryCredentials:
        scr-${TKN_ENV}:
          namespace: ${TKN_NAMESPACE}
          labels:
            app: tekton
          dockerConfigJson: ${TKN_SCR_DOCKERCONFIG}