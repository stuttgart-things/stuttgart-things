---
releases:
  - name: build-kaniko-image
    installed: false
    namespace: tekton-kaniko
    chart: stuttgart-things/yacht-tekton-resources
    version: v0.47.10
    values:
      - "workspaces/tekton-kaniko.yaml.gotmpl"
      - "secrets/scr-registry-credentials.yaml.gotmpl"
      - "secrets/git-ssh-credentials.yaml.gotmpl"
      - "secrets/msteams-notification.yaml.gotmpl"
      - "tasks/git-clone.yaml.gotmpl"
      - "tasks/kaniko.yaml.gotmpl"
      - "tasks/send-msteams-notification.yaml.gotmpl"
      - "pipelines/{{`{{ .Release.Name }}`}}.yaml.gotmpl"
      - "test-runs/run-{{`{{ .Release.Name }}`}}.yaml.gotmpl"

  - name: package-publish-helmchart
    installed: false
    namespace: machine-shop
    chart: stuttgart-things/yacht-tekton-resources
    version: v0.47.10
    values:
      - "workspaces/tekton-helm.yaml.gotmpl"
      - "secrets/scr-registry-credentials.yaml.gotmpl"
      - "secrets/git-ssh-credentials.yaml.gotmpl"
      - "secrets/msteams-notification.yaml.gotmpl"
      - "tasks/git-clone.yaml.gotmpl"
      - "tasks/helm.yaml.gotmpl"
      - "tasks/send-msteams-notification.yaml.gotmpl"
      - "pipelines/{{`{{ .Release.Name }}`}}.yaml.gotmpl"
      - "test-runs/run-{{`{{ .Release.Name }}`}}.yaml.gotmpl"

  - name: build-buildah-image
    installed: true
    namespace: machine-shop
    chart: stuttgart-things/yacht-tekton-resources
    version: v0.47.10
    values:
      - "workspaces/tekton-kaniko.yaml.gotmpl"
      # - "secrets/scr-registry-credentials.yaml.gotmpl"
      # - "secrets/git-ssh-credentials.yaml.gotmpl"
      # - "secrets/msteams-notification.yaml.gotmpl"
      - "tasks/git-clone.yaml.gotmpl"
      - "tasks/buildah.yaml.gotmpl"
      # - "tasks/send-msteams-notification.yaml.gotmpl"
      - "pipelines/{{`{{ .Release.Name }}`}}.yaml.gotmpl"
      # - "test-runs/run-{{`{{ .Release.Name }}`}}.yaml.gotmpl"

repositories:
  - name: stuttgart-things
    url: eu.gcr.io/stuttgart-things
    oci: true

environments:
  labda-vsphere:
    values:
      - environments/defaults.yaml
      - environments/{{ .Environment.Name }}.yaml

helmDefaults:
  verify: false
  wait: false
  timeout: 600
  recreatePods: false
  force: true
