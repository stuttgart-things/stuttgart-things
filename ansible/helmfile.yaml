---
releases:
  - name: terraform
    namespace: machineshop
    chart: stuttgart-things/sthings-cluster
    version: 0.3.7
    installed: true
    values:
      - "values/{{`{{ .Release.Name }}`}}.yaml.gotmpl"

  - name: secrets
    namespace: machineshop
    chart: stuttgart-things/sthings-cluster
    version: 0.3.7
    installed: true
    values:
      - "values/{{`{{ .Release.Name }}`}}.yaml.gotmpl"

  - name: ansible
    namespace: machineshop
    chart: stuttgart-things/sthings-cluster
    version: 0.3.7
    installed: true
    values:
      - "values/{{`{{ .Release.Name }}`}}.yaml.gotmpl"

  - name: job
    namespace: machineshop
    chart: stuttgart-things/sthings-cluster
    version: 0.3.7
    installed: true
    values:
      - "values/{{`{{ .Release.Name }}`}}.yaml.gotmpl"
    needs:
      - "{{`{{ .Release.Namespace }}`}}/secrets"
      - "{{`{{ .Release.Namespace }}`}}/ansible"

#  - name: pdns-ingress-entry
#    namespace: machineshop
#    chart: stuttgart-things/sthings-cluster
#    version: 0.3.7
#    installed: false
#    values:
#      - "plays/{{`{{ .Release.Name }}`}}.yaml.gotmpl"
#      - "secrets/ansible-vault-approle.yaml.gotmpl"
#      - "job/localhost.yaml.gotmpl"

repositories:
  - name: stuttgart-things
    url: eu.gcr.io/stuttgart-things
    oci: true

helmDefaults:
  verify: false
  wait: false
  timeout: 600
  recreatePods: false
  force: true

environments:
  labda-vsphere:
    values:
      - environments/vm.yaml
      - environments/defaults.yaml
      - environments/{{ .Environment.Name }}.yaml
  labul-vsphere:
    values:
      - environments/vm.yaml
      - environments/defaults.yaml
      - environments/{{ .Environment.Name }}.yaml
      - variables/pdns.yaml
