- hosts: all
  become: true

  vars:
    rke_version: 2
    rke2_k8s_version: 1.27.4
    rke2_airgapped_installation: true
    rke2_release_kind: rke2r1 # rke2r2
    disable_rke2_components:
      - rke2-ingress-nginx
      - rke-snapshot-controller
    cluster_setup: singlenode

    deploy_helm_charts: true
    helm_kubeconfig: "{{ rke2_config_dir }}/{{ rke2_kubeconfig_name }}"
    helm_repositories:
      bitnami:
        url: https://charts.bitnami.com/bitnami
    helm_releases:
      metallb:
        ref: bitnami/metallb
        version: 4.7.0
        namespace: metallb-system
        values: |
          ---
  roles:
    - role: deploy-configure-rke